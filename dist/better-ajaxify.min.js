/**
 * better-ajaxify: Ajax website engine for better-dom
 * @version 2.0.0-beta.2 Wed, 01 Mar 2017 09:13:36 GMT
 * @link https://github.com/chemerisuk/better-ajaxify
 * @copyright 2017 Maksim Chemerisuk
 * @license MIT
 */
!function(e,t,a){"use strict";function n(t,a){e.addEventListener(t,function(e){e.defaultPrevented||a(e)},!1)}function i(t,a,n){var i=e.createEvent("CustomEvent");return i.initCustomEvent("ajaxify:"+a,!0,!0,n||null),t.dispatchEvent(i)}function o(t,a,n){i(t,"update",n)&&t.parentNode.replaceChild(n,t),d.body=t,d.title=e.title,s.indexOf(d)<0&&s.push(d),e.title=a}if(a.pushState&&("timeout"in XMLHttpRequest.prototype||window.jasmine)){var r=function(e){return e},s=[],d={},l=null;n("click",function(a){var n,o=a.target;if("a"===o.nodeName.toLowerCase())n=o;else{var r=e.activeElement;"a"===r.nodeName.toLowerCase()&&r.contains(o)&&(n=r)}if(n&&!n.target)if("true"===n.getAttribute("aria-disabled"))a.preventDefault();else if("http"===n.protocol.slice(0,4)){var s=n.href,d=t.href;s===d||s.split("#")[0]!==d.split("#")[0]?i(n,"fetch",n.href)&&a.preventDefault():(t.hash=n.hash,a.preventDefault())}}),n("submit",function(e){var t=e.target;if(!t.target)if("true"===t.getAttribute("aria-disabled"))e.preventDefault();else{var a=t.enctype,n=t.action;if("multipart/form-data"===a)l=new FormData(t);else{for(var o,s="text/plain"===a?r:encodeURIComponent,d=[],u=0;o=t.elements[u];++u)if(o.name&&!o.disabled){var f=o.type,p=s(o.name);if("select-multiple"===f)for(var c,v=0;c=o.options[v];++v)c.selected&&d.push(p+"="+s(c.value));else("checkbox"!==f&&"radio"!==f||o.checked)&&d.push(p+"="+s(o.value))}d.length&&(l=d.join("&").split(s===r?" ":"%20").join("+"),t.method&&"GET"!==t.method.toUpperCase()||(n+=(~n.indexOf("?")?"&":"?")+l,l=null))}i(t,"fetch",n)&&e.preventDefault(),l=null}}),n("ajaxify:fetch",function(e){var t=e.target,a=new XMLHttpRequest,n=(t.method||"GET").toUpperCase();["abort","error","load","timeout"].forEach(function(e){a["on"+e]=function(){1===t.nodeType&&t.setAttribute("aria-disabled","false"),i(t,e,a)}}),a.open(n,e.detail,!0),a.responseType="document",a.data=l,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"!==n&&a.setRequestHeader("Content-Type",t.enctype),i(t,"send",a)&&(1===t.nodeType&&t.setAttribute("aria-disabled","true"),a.send(a.data))}),n("ajaxify:load",function(n){var i=n.detail,r=i.response,l=i.status,u=r.title,f=e.body,p=r.body;if(l>=200&&l<300||304===l){f=e.querySelector("main,[role=main]"),p=f.cloneNode(!1);for(var c;c=r.body.firstChild;)p.appendChild(c)}var v=i.responseURL;v||(v=i.getResponseHeader("Location"),v=v?r.URL.split("/").slice(0,3).join("/")+v:r.URL,Object.defineProperty(i,"responseURL",{get:function(){return v}})),o(f,u,p),d={},v!==t.href&&a.pushState(s.length,u,v)}),window.addEventListener("popstate",function(t){if(!t.defaultPrevented&&t.state>=0){var a=s[t.state];if(a){var n=e.body;"body"!==a.body.nodeName.toLowerCase()&&(n=e.querySelector("main,[role=main]")),n&&(o(n,a.title,a.body),d=a)}}}),a.replaceState(0,e.title)}}(window.document,window.location,window.history);