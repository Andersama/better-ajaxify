/**
 * better-ajaxify: Ajax website engine for better-dom
 * @version 2.1.0-beta.2 Sun, 15 Oct 2017 15:49:33 GMT
 * @link https://github.com/chemerisuk/better-ajaxify
 * @copyright 2017 Maksim Chemerisuk
 * @license MIT
 */
!function(e,t,n){"use strict";function a(t,n){e.addEventListener(t,function(e){e.defaultPrevented||n(e)},!1)}function o(t,n,a){var o=e.createEvent("CustomEvent");return o.initCustomEvent("ajaxify:"+n,!0,!0,a||null),t.dispatchEvent(o)}function r(t,n){var a=e.body,r=(t.body||n.body||{}).id;if(r&&(a=e.getElementById(r)||a),9===n.nodeType){t.body=a.cloneNode(!1);for(var i=n.body.firstChild;i;i=n.body.firstChild)t.body.appendChild(i)}f.body=a,f.title=e.title,s.indexOf(f)<0&&s.push(f),e.title=t.title,o(a,"update",t.body)&&a.parentNode.replaceChild(t.body,a)}if("function"==typeof n.pushState){var i,d=function(e){return e},s=[],f={};a("click",function(n){for(var a=e.body,r=n.target;r&&r!==a;r=r.parentNode)if("a"===r.nodeName.toLowerCase()){if(!r.target){var i=r.href;if(i&&0===i.indexOf("http")){var d=t.href;i===d||i.split("#")[0]!==d.split("#")[0]?o(r,"fetch")&&n.preventDefault():(t.hash=r.hash,n.preventDefault())}}break}}),a("submit",function(e){var t=e.target;if(!t.target){var n,a=t.getAttribute("enctype");if("multipart/form-data"===a)n=new FormData(t);else{n={};for(var r,s=0;r=t.elements[s];++s){var f=r.type;if(f&&r.name&&!r.disabled){var l=r.name;if("select-multiple"===f)for(var u,p=0;u=r.options[p];++p)u.selected&&(n[l]=n[l]||[]).push(u.value);else("checkbox"!==f&&"radio"!==f||r.checked)&&(n[l]=r.value)}}}if(o(t,"serialize",n)){if(n instanceof FormData)i=n;else{var c="text/plain"===a?d:encodeURIComponent,v=c===d?/ /g:/%20/g;i=Object.keys(n).map(function(e){var t=c(e),a=n[e];return Array.isArray(a)&&(a=a.map(c).join("&"+t+"=")),t+"="+c(a)}).join("&").replace(v,"+")}o(t,"fetch")&&e.preventDefault(),i=null}else e.preventDefault()}}),a("ajaxify:fetch",function(a){var d=a.target,l=a.detail;if(l&&9===l.nodeType){var u={title:l.title};r(u,l),f={},l.URL!==t.href&&n.pushState(s.length,u.title,l.URL)}else{var p=new XMLHttpRequest,c=(d.method||"GET").toUpperCase(),v=d.nodeName.toLowerCase(),h=(d.nodeType,l);"a"===v?h=h||d.href:"form"===v&&(h=h||d.action,"GET"===c&&i&&(h+=(~h.indexOf("?")?"&":"?")+i,i=null)),["abort","error","load","timeout"].forEach(function(a){p["on"+a]=function(){var i=p.response,l=p.responseURL;if(!l&&i&&i.URL&&(l=p.getResponseHeader("Location"),l&&(l=t.origin+l,Object.defineProperty(p,"responseURL",{get:function(){return l}}))),o(d,a,p)&&"load"===a){var u=p.status+" "+p.statusText,c=i||e.implementation.createHTMLDocument(u),v={title:c.title||u};r(v,c),f={},l!==t.href&&n.pushState(s.length,v.title,l)}}}),p.open(c,h,!0),p.responseType="document",o(d,"send",p)&&(p.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"!==c&&p.setRequestHeader("Content-Type",d.getAttribute("enctype")||d.enctype),p.send(i))}}),window.addEventListener("popstate",function(e){if(!e.defaultPrevented&&e.state>=0){var t=s[e.state];t&&(r(t,t.body),f=t)}}),n.replaceState(0,e.title)}}(window.document,window.location,window.history);