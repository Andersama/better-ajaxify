/**
 * better-ajaxify: Ajax website engine for better-dom
 * @version 2.0.0-beta.3 Thu, 02 Mar 2017 09:08:38 GMT
 * @link https://github.com/chemerisuk/better-ajaxify
 * @copyright 2017 Maksim Chemerisuk
 * @license MIT
 */
!function(e,t,a){"use strict";function r(t,a){e.addEventListener(t,function(e){e.defaultPrevented||a(e)},!1)}function i(t,a,r){var i=e.createEvent("CustomEvent");return i.initCustomEvent("ajaxify:"+a,!0,!0,r||null),t.dispatchEvent(i)}function n(t,a,r){i(t,"update",r)&&t.parentNode.replaceChild(r,t),u.body=t,u.title=e.title,l.indexOf(u)<0&&l.push(u),e.title=a}if(a.pushState&&("timeout"in XMLHttpRequest.prototype||window.jasmine)){var o,s,d=function(e){return e},l=[],u={};r("click",function(a){var r,n=a.target;if("a"===n.nodeName.toLowerCase())r=n;else{var o=e.activeElement;"a"===o.nodeName.toLowerCase()&&o.contains(n)&&(r=o)}if(r&&!r.target)if("true"===r.getAttribute("aria-disabled"))a.preventDefault();else if("http"===r.protocol.slice(0,4)){var s=r.href,d=t.href;s===d||s.split("#")[0]!==d.split("#")[0]?i(r,"fetch")&&a.preventDefault():(t.hash=r.hash,a.preventDefault())}}),r("submit",function(e){var t=e.target;if(!t.target)if("true"===t.getAttribute("aria-disabled"))e.preventDefault();else{var a,r=t.getAttribute("enctype");if("multipart/form-data"===r)a=new FormData(t);else{a={};for(var n,o=0;n=t.elements[o];++o){var l=n.type;if(l&&n.name&&!n.disabled){var u=n.name;if("select-multiple"===l)for(var f,c=0;f=n.options[c];++c)f.selected&&(a[u]=a[u]||[]).push(f.value);else("checkbox"!==l&&"radio"!==l||n.checked)&&(a[u]=n.value)}}}if(i(t,"serialize",a)){if(a instanceof FormData)s=a;else{var p="text/plain"===r?d:encodeURIComponent,v=p===d?/ /g:/%20/g;s=Object.keys(a).map(function(e){var t=p(e),r=a[e];return Array.isArray(r)&&(r=r.map(p).join("&"+t+"=")),t+"="+p(r)}).join("&").replace(v,"+")}i(t,"fetch")&&e.preventDefault(),s=null}}}),r("ajaxify:fetch",function(e){var t=e.target,a=new XMLHttpRequest,r=(t.method||"GET").toUpperCase(),n=t.nodeName.toLowerCase(),d=e.detail;"a"===n?(d=d||t.href,o&&o.removeAttribute("aria-disabled"),o=t,t.setAttribute("aria-disabled","true")):"form"===n&&(d=d||t.action,"GET"===r&&(d+=(~d.indexOf("?")?"&":"?")+s,s=null),t.setAttribute("aria-disabled","true")),["abort","error","load","timeout"].forEach(function(e){a["on"+e]=function(){"form"===n&&t.removeAttribute("aria-disabled"),i(t,e,a)}}),a.open(r,d,!0),a.responseType="document",i(t,"send",a)&&(a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"!==r&&a.setRequestHeader("Content-Type",t.getAttribute("enctype")||t.enctype),a.send(s))}),r("ajaxify:load",function(r){var i=r.detail,o=i.response,s=i.status,d=o.title,f=e.body,c=o.body;if(s>=200&&s<300||304===s){f=e.querySelector("main,[role=main]"),c=f.cloneNode(!1);for(var p;p=o.body.firstChild;)c.appendChild(p)}var v=i.responseURL;v||(v=i.getResponseHeader("Location"),v=v?o.URL.split("/").slice(0,3).join("/")+v:o.URL,Object.defineProperty(i,"responseURL",{get:function(){return v}})),n(f,d,c),u={},v!==t.href&&a.pushState(l.length,d,v)}),window.addEventListener("popstate",function(t){if(!t.defaultPrevented&&t.state>=0){var a=l[t.state];if(a){var r=e.body;"body"!==a.body.nodeName.toLowerCase()&&(r=e.querySelector("main,[role=main]")),r&&(n(r,a.title,a.body),u=a)}}}),a.replaceState(0,e.title)}}(window.document,window.location,window.history);