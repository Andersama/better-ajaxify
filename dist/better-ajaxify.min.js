/**
 * better-ajaxify: Ajax website engine for better-dom
 * @version 2.0.0-beta.1 Tue, 28 Feb 2017 18:39:00 GMT
 * @link https://github.com/chemerisuk/better-ajaxify
 * @copyright 2017 Maksim Chemerisuk
 * @license MIT
 */
!function(e,t,a,n){"use strict";function i(t,a){e.addEventListener(t,function(e){e.defaultPrevented||a(e)},!1)}function r(t,a,n){var i=e.createEvent("CustomEvent");return i.initCustomEvent("ajaxify:"+a,!0,!0,n||null),t.dispatchEvent(i)}function o(t,a,n){r(t,"update",n)&&t.parentNode.replaceChild(n,t),s.el=t,s.title=e.title,d.indexOf(s)<0&&d.push(s),e.title=a}if(a.pushState&&("timeout"in XMLHttpRequest.prototype||window.jasmine)){var l=function(e){return e},d=[],s={},u=null;i("click",function(a){var n,i=a.target;if("a"===i.nodeName.toLowerCase())n=i;else{var o=e.activeElement;"a"===o.nodeName.toLowerCase()&&o.contains(i)&&(n=o)}if(n&&!n.target)if("true"===n.getAttribute("aria-disabled"))a.preventDefault();else if("http"===n.protocol.slice(0,4)){var l=n.href,d=t.href;l===d||l.split("#")[0]!==d.split("#")[0]?r(n,"fetch",n.href)&&a.preventDefault():(t.hash=n.hash,a.preventDefault())}}),i("submit",function(e){var t=e.target;if(!t.target)if("true"===t.getAttribute("aria-disabled"))e.preventDefault();else{var a=t.enctype,n=t.action;if("multipart/form-data"===a)u=new FormData(t);else{for(var i,o="text/plain"===a?l:encodeURIComponent,d=[],s=0;i=t.elements[s];++s)if(i.name&&!i.disabled){var f=i.type,p=o(i.name);if("select-multiple"===f)for(var c,v=0;c=i.options[v];++v)c.selected&&d.push(p+"="+o(c.value));else("checkbox"!==f&&"radio"!==f||i.checked)&&d.push(p+"="+o(i.value))}d.length&&(u=d.join("&").split("text/plain"===a?" ":"%20").join("+"),t.method&&"GET"!==t.method.toUpperCase()||(n+=(~n.indexOf("?")?"&":"?")+u,u=null))}r(t,"fetch",n)&&e.preventDefault(),u=null}}),i("ajaxify:fetch",function(e){var t=e.target,a=new XMLHttpRequest,n=(t.method||"GET").toUpperCase();["abort","error","load","timeout"].forEach(function(e){a["on"+e]=function(){1===t.nodeType&&t.setAttribute("aria-disabled","false"),r(t,e,a)}}),a.open(n,e.detail,!0),a.responseType="document",a.data=u,a.setRequestHeader("X-Requested-With","XMLHttpRequest"),"GET"!==n&&a.setRequestHeader("Content-Type",t.enctype),r(t,"send",a)&&(1===t.nodeType&&t.setAttribute("aria-disabled","true"),a.send(a.data))}),i("ajaxify:load",function(i){var r=i.detail,l=r.response,u=l.body,f=e.body,p=u,c=r.getResponseHeader(n);if(!c){var v=l.querySelector("[http-equiv="+n+"]");c=v?v.content:null}if(c){f=e.getElementById(c),p=f.cloneNode(!1);for(var h;h=u.firstChild;)p.appendChild(h)}var m=l.URL||r.responseURL,y=l.title||e.title;o(f,y,p),s={},m!==t.href&&a.pushState(d.length,y,m)}),window.addEventListener("popstate",function(t){if(!t.defaultPrevented&&t.state>=0){var a=d[t.state];if(a){var n=a.el.id,i=n?e.getElementById(n):e.body;i&&(o(i,a.title,a.el),s=a)}}}),a.replaceState(0,e.title)}}(window.document,window.location,window.history,"X-Ajaxify-Target");